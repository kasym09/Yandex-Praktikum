https://nbviewer.org/github/kasym09/Yandex-Praktikum/blob/main/Final%20Project/Customer%20Churn%20Prediction%20Model..ipynb
# Модель для предсказания оттока клиентов

## Описание проекта:
Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.

# Описание услуг
Оператор предоставляет два основных типа услуг: 
Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.
Интернет. Подключение может быть двух типов: через телефонную линию (DSL, от англ. digital subscriber line, «цифровая абонентская линия») или оптоволоконный кабель (Fiber optic).

Также доступны такие услуги:
Интернет-безопасность: антивирус (DeviceProtection) и блокировка небезопасных сайтов (OnlineSecurity);
Выделенная линия технической поддержки (TechSupport);
Облачное хранилище файлов для резервного копирования данных (OnlineBackup);
Стриминговое телевидение (StreamingTV) и каталог фильмов (StreamingMovies).
За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.

## Описание данных

Данные состоят из файлов, полученных из разных источников:

- contract_new.csv — информация о договоре;
- personal_new.csv — персональные данные клиента;
- internet_new.csv — информация об интернет-услугах;
- phone_new.csv — информация об услугах телефонии.

Во всех файлах столбец customerID содержит код клиента.
Информация о договорах актуальна на 1 февраля 2020.


# План работы

- Загрузка и ознакомление с данными, проверка на пропуски и дубликаты. Подготовить данные к дальнейшиму анализу
- Выделение целевого признака
- Объединение данных
- Исследование данных (разведочный анализ, EDA)
- Проверка корреляций, удалить столбцы с низкой и высокой корреляцией
- Разработать и обучить несколько моделей машинного обучения для решения задачи, г для решения задачи бинарной классификации. Выбрать наилучшую модель по метрике ROC-AUC >= 0.85. При разработке модели учитывать проблему переобучения; провести масштабирование и нормализацию признаков, где необходимо.
- посчитать дополнительную метрику accuracy
- проанализировать матрицу ошибок и важность признаков


# Отчет о проделанной работе
**В ходе работы были выполнены следющие операции:**
  #### 1. Загружены и изучены данные;
  
  #### 2. Выполнена предобработка данных;

Пропусков в исходном датасете не наблюдалось, но после объеденения датасетов появились пропуски. Они появились из за того что, не все пользыватели пользывались всеми услугами компании.(Например телефонии и интернетом.) такие пропуски были заменены на 'Undefined'


 #### 3. Сформированы признаки;

Duration, целевой признак  Churn

  #### 4. Проведён исследовательский анализ данных;
  
 
  #### 5. Проведена проверка данных на коллинеарность;
  
Удалены признаки непригодные для ML: EndDate, StardDate, CustomerId
  
удалены за низкую и высокую корреляцию Gender, StreamingMovies и TechSupport.


  #### 6. Подготовлены тренировочная и тестовая выборки;
  
RANDOM_STATE = 2102023, данные разделены 3 к 1
 
  #### 7. Выбрано несколько моделей, определены их лучшие гиперпаметры, модели обучены, протестировано предсказание лучшей модели;
  
  
  #### 8. Анализ важности признаов. 
  
  У выбранной модели было установлено, что призанки 'InternetService', 'StreamingTV' никак не влияют на принятие решение модели, и они были удалены. По важности cильно в отрыве Duration, она и не удивительно, как мы ранее исследовали основной поток ушедших это те у кого заканчивались годовые, 2-х и.тд контракты.
  
**Ключевые шаги в решении задачи**
  1. Анализ данных и подготовка признаков;
  2. Настройка моделей.
  
**Признаки для обучения модели и их предобработка**
  1. Для обучения модели использовались исходные признаки за исключением 'gender', 'begin_date', 'end_date', 'StreamingMovies', 'TechSupport' и один дополнительно сгенерированный признак 'duration' - срок действия контракта в днях;
  2. Данные всех признаков приведены к требуемому типу, отсутсвующие значения заполнены, дубликаты отсутвуют.
  
**Итоговая модель, её гиперпараметы и качество**
  1. Итоговая модель CatBoostClassifier со следующими параметрами:
- depth = 2
- iterations = 2000
- learning_rate = 0.1
  2. Тестовый результат метрики AUC-ROC: 0.93 
  3. Тестовый результат метрики Accuracy: 0.94
    


Данная модель CatBoostClassifier была тщательно настроена и протестирована на тестовой выборке, продемонстрировав выдающееся качество предсказаний. Это позволяет с большой уверенностью рекомендовать её использование для решения задачи бизнес-заказчика, связанной с прогнозированием оттока клиентов.

Гиперпараметры модели: Глубина дерева (depth), количество итераций (iterations) и скорость обучения (learning_rate) были оптимально настроены и подобраны на тренировочных данных. Эти гиперпараметры позволили достичь высокой производительности модели.

Метрики качества:

AUC-ROC (Area Under the Receiver Operating Characteristic Curve) составляет 0.93. Это означает, что модель хорошо различает классы и обладает способностью выявлять клиентов, склонных к оттоку.
Accuracy составляет 0.94, что также является впечатляющим результатом и указывает на точность модели.
Внедрение в эксплуатацию:

Модель может быть использована для идентификации клиентов, которые вероятно покинут компанию, что позволит предпринимать целенаправленные действия по удержанию таких клиентов.
Эффективность модели также позволит компании оптимизировать бюджет и ресурсы, направленные на удержание клиентов. Модель поможет сосредоточить усилия на наиболее перспективных клиентах.
Периодическое обновление модели с учетом появляющихся данных и изменений в компании позволит поддерживать её актуальность и эффективность.
В целом, данная модель представляет собой мощный инструмент для борьбы с оттоком клиентов и повышения эффективности работы компании. Следует рассмотреть её внедрение в рамках бизнес-процессов с последующим мониторингом и обновлением для достижения наилучших результатов.
